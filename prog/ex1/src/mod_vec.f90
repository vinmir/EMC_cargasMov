!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!
! Módulo de subrotinas de vetores:
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!
module vector_sub
use :: constantes
implicit none

! Declaração de variáveis do módulo:

! Declaração de procedures do módulo:
contains
!**********************************************************************************************************************************!
function cross(a,b) result(c)
!! Função que calcula o produto vetorial de dois vetores.

! IN
real(dp), dimension(3), intent(in) :: a,b
! OUT:
real(dp), dimension(3) :: c

! Execução:
c(1) = a(2)*b(3)-a(3)*b(2)
c(2) = a(3)*b(1)-a(1)*b(3)
c(3) = a(1)*b(2)-a(2)*b(1)

end function 
!**********************************************************************************************************************************!

!**********************************************************************************************************************************!
function norm(vec)
!! Função que calcula a norma de um vetor.

! IN
real(dp), dimension(3), intent(in) :: vec
! OUT:
real(dp) :: norm

! Execução:
norm = sqrt(dot_product(vec,vec))

end function 
!**********************************************************************************************************************************!


!**********************************************************************************************************************************!
function normalize(vec)
!! Função que normaliza um vetor.

! IN
real(dp), dimension(3), intent(in) :: vec
! OUT:
real(dp), dimension(3) :: normalize

! Execução:
normalize = vec/norm(vec)

end function 
!**********************************************************************************************************************************!

end module
